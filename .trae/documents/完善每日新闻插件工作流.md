# 完善每日新闻插件工作流

## 问题分析
当前插件已经具备基本的工作流架构，但需要调整为用户要求的模式：
1. 先把所有用户配置的链接发给subagent
2. subagent汇报给主agent
3. 主agent决定每个subagent要写什么
4. subagent执行任务
5. 自动化汇总

## 解决方案
### 1. 修改工作流流程
调整 `NewsWorkflowManager.run_workflow()` 方法，增加subagent汇报环节：
- 第一步：获取所有新闻源配置
- 第二步：subagent初步分析源并汇报
- 第三步：主agent根据汇报制定具体任务
- 第四步：subagent执行具体任务
- 第五步：主agent汇总结果

### 2. 增强SubAgent功能
修改 `WechatSubAgent` 类，增加初步分析和汇报能力：
- 添加 `analyze_source()` 方法，用于初步分析源
- 添加 `report_to_main_agent()` 方法，用于向主agent汇报

### 3. 增强MainAgent决策能力
修改 `MainNewsAgent` 类，增强决策能力：
- 添加 `analyze_sub_agent_reports()` 方法，用于分析subagent的汇报
- 修改 `summarize_all_results()` 方法，优化汇总逻辑

### 4. 完善配置管理
- 确保用户配置的新闻源能正确加载
- 优化配置存储和读取逻辑

### 5. 增强错误处理
- 添加更详细的错误日志
- 增强容错能力

## 实现步骤
1. 修改 `workflow/agents.py` 中的 `NewsWorkflowManager.run_workflow()` 方法
2. 修改 `WechatSubAgent` 类，增加初步分析和汇报功能
3. 修改 `MainNewsAgent` 类，增强决策能力
4. 测试工作流流程是否正确
5. 优化代码结构和错误处理

## 预期效果
- 工作流按照用户要求的架构运行
- subagent能够初步分析源并汇报
- 主agent能够根据汇报制定具体任务
- 自动化汇总生成高质量的日报
- 增强插件的稳定性和容错能力